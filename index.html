<!-- FILE: index.html -->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="format-detection" content="telephone=no" />
  <title>ã€TalisPodã€‘</title>

  <!-- æ—¢å­˜ãƒ‡ã‚¶ã‚¤ãƒ³ã¯ app.css å‰æ -->
  <link rel="stylesheet" href="./css/app.css?v=079" />

  <!-- iPhoneã®å…¥åŠ›ã‚ºãƒ¼ãƒ æŠ‘åˆ¶ï¼ˆä¿é™ºï¼‰ -->
  <meta name="apple-mobile-web-app-capable" content="yes" />

  <script>
window.addEventListener('error', function(e){
  try{
    const m = document.createElement('div');
    m.style.cssText = 'position:fixed;left:8px;right:8px;top:8px;z-index:99999;background:rgba(0,0,0,.85);color:#fff;padding:10px;border-radius:12px;font-size:12px;line-height:1.4;white-space:pre-wrap;';
    m.textContent = 'JS ERROR:\n' + (e.message || e.error || 'unknown') + '\n' + (e.filename||'') + ':' + (e.lineno||'') ;
    document.body.appendChild(m);
  }catch(_){}
});
window.addEventListener('unhandledrejection', function(e){
  try{
    const m = document.createElement('div');
    m.style.cssText = 'position:fixed;left:8px;right:8px;top:8px;z-index:99999;background:rgba(60,0,0,.85);color:#fff;padding:10px;border-radius:12px;font-size:12px;line-height:1.4;white-space:pre-wrap;';
    m.textContent = 'PROMISE ERROR:\n' + (e.reason && (e.reason.message||e.reason) || 'unknown');
    document.body.appendChild(m);
  }catch(_){}
});
</script>
  <script>document.documentElement.style.outline="6px solid #ff00ff";</script>
</head>

<body class="unreborn">

  <!-- ===== Header ===== -->
  <header class="header" role="banner">
    <div class="header-inner header-inner--with-action">
      <div class="header-left">
        <!-- â˜…ä¿®æ­£ï¼šTalisyPod â†’ TalisPodï¼ˆè‹±èªã®ã¿ï¼‰ -->
        <div class="header-title">ã€TalisPodã€‘</div>

        <div class="header-lines">
          <div id="headerLine1" class="line"></div>
          <div id="headerLine2" class="line"></div>
          <div id="headerLine3" class="line"></div>
        </div>
      </div>

      <div class="header-right">
        <button id="comebackBtn" type="button" class="btn-dual">
          <span class="jp">ã‚«ãƒ ãƒãƒƒã‚¯</span>
          <span class="en">Comeback</span>
        </button>
      </div>
    </div>
  </header>

  <!-- ===== Start View ===== -->
  <main id="startView" class="view active" role="main">
    <div class="container">
      <div class="start-card">
        <h2>
          <span class="tsp-dual">
            <span class="jp">ã‚µãƒ¼ã‚¬ã®åã‚’åˆ»ã‚</span>
            <span class="en">Name your saga</span>
          </span>
        </h2>

        <div class="field">
          <label for="sagaInput">
            <span class="tsp-inline">
              <span class="jp">ã‚µãƒ¼ã‚¬å</span><span class="sep">/</span><span class="en">Saga Name</span>
            </span>
            <span class="small-en">ï¼ˆå¾Œã‹ã‚‰å¤‰æ›´ã§ãã¾ã›ã‚“ / Cannot be changed laterï¼‰</span>
          </label>
          <input id="sagaInput" type="text" inputmode="text" autocomplete="off" placeholder="" />
        </div>

        <h2>
          <span class="tsp-dual">
            <span class="jp">ã‚½ã‚¦ãƒ«ãƒ‰ãƒ¼ãƒ«ã®è¨˜æ†¶</span>
            <span class="en">Soul doll memory</span>
          </span>
        </h2>

        <div class="field">
          <label for="soulTextInput">
            <span class="tsp-dual">
              <span class="jp">ã‚½ã‚¦ãƒ«ãƒ‰ãƒ¼ãƒ«ã®è¨˜æ†¶ï¼ˆSOUL1:ã€œï¼‰</span>
              <span class="en">Memory code (SOUL1:...)</span>
            </span>
          </label>
          <textarea id="soulTextInput" placeholder=""></textarea>
        </div>

        <div class="start-actions">
          <button id="textRebornBtn" type="button" class="btn-dual">
            <span class="jp">ã‚½ã‚¦ãƒ«ãƒ‰ãƒ¼ãƒ«ã‚’ãƒªãƒœãƒ¼ãƒ³ã™ã‚‹</span>
            <span class="en">Reborn from Soul doll</span>
          </button>
        </div>

        <h2 style="margin-top:16px;">
          <span class="tsp-dual">
            <span class="jp">ã‚½ã‚¦ãƒ«ãƒ‰ãƒ¼ãƒ«ã‚’æŒã£ã¦ã„ãªã„</span>
            <span class="en">No have Soul dolls</span>
          </span>
        </h2>

        <div class="start-actions">
          <button id="newSoulBtn" type="button" class="btn-dual">
            <span class="jp">æ–°ãŸãªã‚½ã‚¦ãƒ«ãƒ‰ãƒ¼ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹</span>
            <span class="en">Find a new Soul doll</span>
          </button>
        </div>
      </div>
    </div>
  </main>

  <!-- ===== Main View ===== -->
  <main id="mainView" class="view" role="main">
    <div class="container">

      <!-- ===== HOME ===== -->
      <section id="tab-home" class="tab-content active" aria-label="home">
        <div class="scene attr-none">

          <div class="home-top home-top--with-action">
            <div class="kv">
              <div>
                <strong>
                  <span class="tsp-inline">
                    <span class="jp">ç’°å¢ƒ</span><span class="sep">/</span><span class="en">Environment</span>
                  </span>ï¼š
                </strong>
                <span id="envAttributeLabel">ç„¡å±æ€§</span>
              </div>

              <div>
                <strong>
                  <span class="tsp-inline">
                    <span class="jp">è‚²æˆ</span><span class="sep">/</span><span class="en">Growth</span>
                  </span>ï¼š
                </strong>
                <span id="growthTimer">ç’°å¢ƒæˆé•·ãªã—</span>
              </div>

              <div id="growthPreview" class="kv"></div>
            </div>
          </div>

          <!-- sprite -->
          <div id="spriteMover" aria-label="legendz-mover">
            <div id="spriteViewport" aria-label="legendz-sprite">
              <div id="spriteSheetLayer"></div>
              <div id="spriteFxLayer"></div>
            </div>
          </div>
        </div>

        <!-- ç„¡å±æ€§ãƒœã‚¿ãƒ³ã¯ scene ã®å¤–ï¼ˆç›´ä¸‹ï¼‰ -->
        <div class="home-bottom-actions">
          <button id="homeNeutralBtn" type="button" class="ghost btn-dual">
            <span class="jp">ç„¡å±æ€§ç’°å¢ƒã«ã™ã‚‹</span>
            <span class="en">Set Neutral</span>
          </button>
        </div>
      </section>

      <!-- ===== ENVIRONMENT ===== -->
      <section id="tab-environment" class="tab-content" aria-label="environment">
        <div class="panel">
          <h2 style="margin:0 0 10px;">
            <span class="tsp-inline">
              <span class="jp">ç’°å¢ƒ</span><span class="sep">/</span><span class="en">Environment</span>
            </span>
          </h2>

          <div class="env-grid">
            <div class="env-top-actions">
              <button id="neutralBtn" type="button" class="ghost btn-dual">
                <span class="jp">ç„¡å±æ€§ã«æˆ»ã™</span>
                <span class="en">Reset to Neutral</span>
              </button>
            </div>

            <div class="env-row">
              <div class="label">
                <span class="tsp-inline">
                  <span class="jp">æ¸©åº¦</span><span class="sep">/</span><span class="en">Temperature</span>
                </span>
                <strong id="tempValue">0â„ƒ</strong>
              </div>
              <div class="range-wrap">
                <input id="tempSlider" type="range" value="0" />
              </div>
            </div>

            <div class="env-row">
              <div class="label">
                <span class="tsp-inline">
                  <span class="jp">æ¹¿åº¦</span><span class="sep">/</span><span class="en">Humidity</span>
                </span>
                <strong id="humidityValue">50ï¼…</strong>
              </div>
              <div class="range-wrap">
                <input id="humiditySlider" type="range" value="0" />
              </div>
            </div>

            <div class="env-row">
              <div class="label">
                <span>
                  <span id="lightLabel">å…‰é‡</span><span class="small-en"> / Light/Depth</span>
                </span>
                <strong id="lightValue">50</strong>
              </div>

              <div class="light-buttons" role="group" aria-label="light-buttons">
                <button id="lightBtn0" type="button" class="light-btn" data-light="0">0</button>
                <button id="lightBtn50" type="button" class="light-btn active" data-light="50">50</button>
                <button id="lightBtn100" type="button" class="light-btn" data-light="100">100</button>
              </div>
            </div>

            <div class="env-preview">
              <span class="tsp-inline">
                <span class="jp">äºˆæƒ³ç’°å¢ƒ</span><span class="sep">/</span><span class="en">Preview</span>
              </span>ï¼š
              <strong id="envPreviewLabel">ç„¡å±æ€§</strong>
            </div>

            <div class="env-actions">
              <div class="row">
                <button id="applyEnvBtn" type="button" class="btn-dual">
                  <span class="jp">ç’°å¢ƒæ±ºå®š</span>
                  <span class="en">Apply</span>
                </button>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- ===== LEGENDZ ===== -->
      <section id="tab-legendz" class="tab-content" aria-label="legendz">
        <div class="panel">
          <h2 style="margin:0 0 10px;">
            <span class="tsp-inline">
              <span class="jp">ãƒ¬ã‚¸ã‚§ãƒ³ã‚º</span><span class="sep">/</span><span class="en">Legendz</span>
            </span>
          </h2>

          <div class="legendz-head">
            <div class="kvline">
              <span class="tsp-inline">
                <span class="jp">ç¨®æ—å</span><span class="sep">/</span><span class="en">Species</span>
              </span>
              <strong id="speciesName">-</strong>

              <span class="sep">ã€€</span>

              <span class="tsp-inline">
                <span class="jp">å±æ€§</span><span class="sep">/</span><span class="en">Attribute</span>
              </span>
              <strong id="legendzAttribute">-</strong>
            </div>

            <div class="nick-edit nick-edit--top">
              <label for="nicknameInput" style="color:var(--muted); font-size:13px;">
                <span class="tsp-inline">
                  <span class="jp">ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ </span><span class="sep">/</span><span class="en">Nickname</span>
                </span>
              </label>
              <input id="nicknameInput" type="text" autocomplete="off" />
              <button id="nicknameApplyBtn" type="button" class="btn-dual">
                <span class="jp">ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å¤‰æ›´</span>
                <span class="en">Update</span>
              </button>
            </div>
          </div>

          <div class="legendz-grid">
            <div class="kvline">
              <span class="tsp-inline"><span class="jp">HP</span><span class="sep">/</span><span class="en">HP</span></span>
              <strong id="hpStat">-</strong>
            </div>
            <div class="kvline">
              <span class="tsp-inline"><span class="jp">ãƒãƒ›ã‚¦</span><span class="sep">/</span><span class="en">Magic</span></span>
              <strong id="magicStat">-</strong>
            </div>
            <div class="kvline">
              <span class="tsp-inline"><span class="jp">ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼</span><span class="sep">/</span><span class="en">Counter</span></span>
              <strong id="counterStat">-</strong>
            </div>
            <div class="kvline">
              <span class="tsp-inline"><span class="jp">ãƒ€ã‚²ã‚­</span><span class="sep">/</span><span class="en">Strike</span></span>
              <strong id="strikeStat">-</strong>
            </div>
            <div class="kvline">
              <span class="tsp-inline"><span class="jp">ã‚«ã‚¤ãƒ•ã‚¯</span><span class="sep">/</span><span class="en">Heal</span></span>
              <strong id="healStat">-</strong>
            </div>
          </div>

          <div class="skills">
            <h3 style="margin:14px 0 8px;">
              <span class="tsp-inline">
                <span class="jp">ãƒ¯ã‚¶</span><span class="sep">/</span><span class="en">Skills</span>
              </span>
            </h3>
            <div id="skillSlots" class="skill-slots" aria-label="skill-slots"></div>
          </div>
        </div>
      </section>

      <!-- ===== CRYSTAL ===== -->
      <section id="tab-crystal" class="tab-content" aria-label="crystal">
        <div class="panel">
          <h2 style="margin:0 0 10px;">
            <span class="tsp-inline">
              <span class="jp">ã‚¯ãƒªã‚¹ã‚¿ãƒ«</span><span class="sep">/</span><span class="en">Crystals</span>
            </span>
          </h2>
          <div id="crystalList" class="crystal-box"></div>
        </div>
      </section>

    </div>
  </main>

  <!-- ===== Tabs ===== -->
  <!-- ãƒ«ãƒ¼ãƒ«ï¼šã‚¿ãƒ–ã¯è‹±å˜èªã®ã¿ï¼ˆï¼‹çµµæ–‡å­—ã¯OKï¼‰ -->
  <nav class="tabs" aria-label="tabs">
    <button class="tab-btn active" data-tab="home" type="button">
      <div class="ico">ğŸ </div>
      <div>Home</div>
      <div class="dot"></div>
    </button>
    <button class="tab-btn" data-tab="environment" type="button">
      <div class="ico">ğŸŒ¡ï¸</div>
      <div>Env</div>
      <div class="dot"></div>
    </button>
    <button class="tab-btn" data-tab="legendz" type="button">
      <div class="ico">ğŸ‰</div>
      <div>Legendz</div>
      <div class="dot"></div>
    </button>
    <button class="tab-btn" data-tab="crystal" type="button">
      <div class="ico">ğŸ’</div>
      <div>Crystal</div>
      <div class="dot"></div>
    </button>
  </nav>

  <!-- ===== Scripts ===== -->
  <script src="./js/state.js?v=079"></script>
  <script src="./js/areaMap.js?v=079"></script>
  <script src="./js/areaResolver.js?v=079"></script>
  <script src="./js/game.js?v=079"></script>
  <script src="./js/app.js?v=079"></script>
</body>
</html>


